<!-- Time for a little CSS! -->
<style type='text/css'>

    
    .padded{
        padding:10%;
    }
    
    body{
        overflow-y:none;
    }

    .active {
        border:1px solid red;
    }

    .gameModes {
        text-align: center;
    }

    .gameModeContainer {
        background-color: aquamarine;
        width: 40vw;
        height: 40vw;
        max-width: 400px;
        max-height: 400px;
        margin-left: 2vw;
        margin-right: 2vw;
        display: inline-block;
        position: relative;
        border-radius: 6px;
    }

    .gameModeTitleContainer {
        position: absolute;
        bottom: 0;
        background-color: gray;
        width: 100%;
        height: 10%;
        display: table;
    }

    .gameModeTitleContainer .title {
        height: 100%;
    display: table-cell;
    text-align: center;
    vertical-align: middle;
    font-size: 1.5em;
    color: white;
    }

    .gameModeDescriptionContainer {
        text-align: center;
        margin-top: 20px;
        margin-bottom: 20px;
    }

    .full-length {
        width: 100%;
    }

    .half-length {
        width: 50%;
    }

    .box {
        background-color: #fff;
        border-radius: 6px;
        box-shadow: 0 0.5em 1em -0.125em rgba(10,10,10,.1), 0 0 0 1px rgba(10,10,10,.02);
        color: #4a4a4a;
        display: block;
        padding: 1.25rem;
        display: inline-block;
    }
    
    button {
        background-color: #fff;
    border-color: #dbdbdb;
    border-width: 1px;
    color: #363636;
    cursor: pointer;
    justify-content: center;
    padding-bottom: calc(.5em - 1px);
    padding-left: 1em;
    padding-right: 1em;
    padding-top: calc(.5em - 1px);
    text-align: center;
    white-space: nowrap;
    font-size: 2em;
    border-radius: 6px;
    }

    .classicMode {
        background-image: "GameSelectResources/ClassicMode.png";
    }

    .exhibitionMode {
        background-image: "GameSelectResources/ExhibitionThumb.png";
    }
</style>
    
    <div style='padding:2vw;'>
       <h1 style="text-align: center;">Game Select</h1>
        <br>
        <div class="gameModes">
            <div class="gameModeContainer interactable active classicMode" data-group=1 data-gameMode="classic" data-onSelect="gameModeSelected">
                
            </div>
            <div class="gameModeContainer interactable exhibitionMode" data-group=1 data-gameMode="exhibition" data-onSelect="gameModeSelected">
                
            </div>
            <div class="full-legth gameModeDescriptionContainer">
                <div class="box half-length">
                    Blah Blah blah describe game mode!
                </div>

            </div>
            <div class="full-length">
                <button data-group=2 class="interactable"> Next </button>
            </div>
        </div>
    </div>
    
    <script type='text/javascript'>
    console.log("Hello world")
    var LEFT = 0;
    var RIGHT = 1;
    var SELECT = 2;

   var selectableDict = [[],[]];
   var currentRow = 0;
   var rowCount = 2;

    function initialSetup() {
        var interactables = Array.from(document.getElementsByClassName("interactable"));
        interactables.forEach(element => {
            switch (element.dataset.group) {
                case "1": 
                    selectableDict[0].push({"element":element,"selected":0});
                    break
                case "2": 
                    selectableDict[1].push({"element":element,"selected":0});
                    break
                default:break
            }
        })
    }

    function recieveInput(input) {
        
        console.log(input);
        if (input == 0 || input == 97) {
            moveSelectedLeft()
        } else if (input == 1 || input == 100) {
            moveSelectedRight()
        } else if (input == 2 || input == 119) {
            moveSelectedUp()
        } else if (input == 3 || input == 115) {
            moveSelectedDown()
        } else if (input == 2 || input == 13) {

        }
    }

    function moveSelectedRight() {
        let interactables = Object.values(selectableDict[currentRow]);
        var selectedIndex = interactables.findIndex(isActive);
        var newIndex = selectedIndex + 1
        if (newIndex >= selectableDict[currentRow].length) {  
                recieveInput(115);
        } else {
                document.getElementsByClassName("active")[0].classList.remove("active");
                selectableDict[currentRow][newIndex].element.classList.add("active");
        }
    }

    function moveSelectedLeft() {
        let interactables = Object.values(selectableDict[currentRow]);
        var selectedIndex = interactables.findIndex(isActive);
        var newIndex = selectedIndex - 1
        if (newIndex < 0){
            recieveInput(119);
            
        } else {
            document.getElementsByClassName("active")[0].classList.remove("active");                
            selectableDict[currentRow][newIndex].element.classList.add("active");
        }
    }

    function moveSelectedUp() {
        var newIndex = currentRow - 1

        if (newIndex < 0) {
            console.log("Start of input rows") 
        } else {
        let interactables = Object.values(selectableDict[currentRow]);
        var selectedIndex = interactables.findIndex(isActive);
            if (selectedIndex > selectableDict[newIndex].length - 1) {
                selectedIndex = selectableDict[newIndex].length - 1
            }
            document.getElementsByClassName("active")[0].classList.remove("active");
            selectableDict[newIndex][selectedIndex].element.classList.add("active");
            currentRow = newIndex;
        }
    }

    function moveSelectedDown() {
        var newIndex = currentRow + 1

        if (newIndex >= selectableDict.length) {
            console.log("End of input rows")
            
        } else {
            let interactables = Object.values(selectableDict[currentRow]);
            var selectedIndex = interactables.findIndex(isActive);
            if (selectedIndex > selectableDict[newIndex].length - 1) {
                selectedIndex = selectableDict[newIndex].length - 1
            }
            document.getElementsByClassName("active")[0].classList.remove("active");
            selectableDict[newIndex][selectedIndex].element.classList.add("active");
            currentRow = newIndex;
        }
    }

    this.addEventListener('keypress', event => {
        recieveInput(event.keyCode);
    })

    function isActive(element, index, array) {
        return (element["element"].classList.contains("active"));
    }

    function gameModeSelected(object) {
        console.log("GAME MODE SELECTED")
    }

    initialSetup();
    
    </script>